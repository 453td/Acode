name: Build Android 
on: 
  push: 
  
  workflow_dispatch:
      inputs:
        forceRun:
          description: 'ForceRun - Forcefully runs the workflow regardless of whether its running in a fork or not'
          required: false
          default: false
          type: boolean
jobs: 
   build: 
     name: Build APK 
     runs-on: ubuntu-latest 
     if: github.repository == 'deadlyjack/Acode' && !contains(github.event.head_commit.message, 'skip ci') || inputs.forceRun == true
     steps: 
       - name: Checkout source 
         uses: actions/checkout@v4
  
       - name: Setup java 
         uses: actions/setup-java@v4 
         with: 
           distribution: 'zulu' # See 'Supported distributions' for available options 
           java-version: '17' # only 11 works for this project  
  
       - name: Setup Node.js 
         uses: actions/setup-node@v4
         with: 
  
           node-version: 20.x 
  
  
       - name: Install Cordova 
         run: npm install -g cordova 
  
       - name: Install yarn 
         run: npm install -g yarn 
  
       - name: Install app dependencies 
         run: yarn setup 
  
       - name: Configure the platform 
         run: yarn clean 
  
       # - name: Add Android platform 
       #   run: cordova platform add android 
  
       - name: Build Android dev apk 
         run: yarn build android paid dev 
  
       - name: Build Android prod aab 
         run: yarn build android paid prod 
         id: android-aab-build
  
       - name: Sign 
         run: | 
               sudo chmod 777 ./sign.sh 
               ./sign.sh 
  
       - name: Upload dev APK 
         uses: actions/upload-artifact@v4
         with: 
           name: app-development-prod-included
           path: ./*.apk 
  
       - name: Upload release bundle 
         uses: actions/upload-artifact@v4
         with: 
           name: app-release-aab
           path: ./*.aab
